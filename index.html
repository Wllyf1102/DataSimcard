<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard OP - Simcard</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
    }

    body {
      display: flex;
      min-height: 100vh;
      background-color: #f4f6f8;
    }

    .sidebar {
      width: 220px;
      background-color: #1e293b;
      color: #fff;
      padding: 30px 20px;
    }

    .sidebar h2 {
      font-size: 20px;
      margin-bottom: 20px;
    }

    .sidebar ul {
      list-style: none;
    }

    .sidebar ul li {
      padding: 10px;
      cursor: pointer;
      color: #cbd5e1;
    }

    .sidebar ul li:hover {
      background-color: #334155;
      border-radius: 6px;
      color: #fff;
    }

    .main {
      flex: 1;
      padding: 40px;
    }

    .card {
      background-color: #ffffff;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      display: flex;
      align-items: center;
      gap: 20px;
      max-width: 400px;
    }

    .card-icon {
      background-color: #e0f2fe;
      color: #0284c7;
      padding: 16px;
      border-radius: 50%;
      font-size: 24px;
    }

    .card-content h3 {
      margin-bottom: 5px;
      color: #334155;
      font-size: 18px;
    }

    .card-content p {
      font-size: 24px;
      font-weight: 600;
      color: #0f172a;
    }
  </style>
</head>
<body>
  <body class="sidebar-dark">
  <div class="main-wrapper">
    <nav class="sidebar">
  <div class="sidebar-header">
    <a href="/" class="sidebar-brand">
      SIM <span>Card</span>
    </a>
    <div class="sidebar-toggler not-active">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
  <div class="sidebar-body">
    <ul class="nav" id="mainMenu">

        
                    <li class="nav-item nav-category">Main</li>
            <li class="nav-item">
                <a href="/dashboard" class="nav-link">
                    <i class="link-icon" data-feather="box"></i>
                    <span class="link-title">Dashboard OP</span>
                </a>
            </li>
        
        
                    <li class="nav-item nav-category">web apps</li>
        
                    <li class="nav-item">
                <a href="/provider" class="nav-link">
                    <i class="link-icon" data-feather="radio"></i>
                    <span class="link-title">Provider</span>
                </a>
            </li>
                            <li class="nav-item">
                <a href="/card" class="nav-link">
                    <i class="link-icon" data-feather="smartphone"></i>
                    <span class="link-title">Sim Card</span>
                </a>
            </li>
                            <li class="nav-item">
                <a href="/transaction" class="nav-link">
                    <i class="link-icon" data-feather="credit-card"></i>
                    <span class="link-title">Transaction</span>
                </a>
            </li>
        
        
                    <li class="nav-item nav-category">Miscellaneous</li>
                
        
                    <li class="nav-item">
                <a href="/user" class="nav-link">
                    <i class="link-icon" data-feather="users"></i>
                    <span class="link-title">Users</span>
                </a>
            </li>
        
                    <li class="nav-item">
                <a href="/logs" class="nav-link">
                    <i class="link-icon" data-feather="activity"></i>
                    <span class="link-title">Logs</span>
                </a>
            </li>
        
                    <li class="nav-item">
                <a href="/site" class="nav-link">
                    <i class="link-icon" data-feather="aperture"></i>
                    <span class="link-title">Site</span>
                </a>
            </li>
            </ul>
</div>
</nav>
    <div class="page-wrapper">
      <nav class="navbar">
    <a href="#" class="sidebar-toggler">
        <i data-feather="menu"></i>
    </a>
    <div class="navbar-content">
        <ul class="navbar-nav">
            <li class="nav-item dropdown nav-profile">
                <a class="nav-link dropdown-toggle" href="#" id="profileDropdown" role="button"
                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <img src="https://firebase.sgp1.cdn.digitaloceanspaces.com/default.png" alt="profile">
                </a>
                <div class="dropdown-menu" aria-labelledby="profileDropdown">
                    <div class="dropdown-header d-flex flex-column align-items-center">
                        <div class="figure mb-3">
                            <img src="https://firebase.sgp1.cdn.digitaloceanspaces.com/default.png" alt="profile">
                        </div>
                        <div class="info text-center">
                            <p class="name font-weight-bold text-muted mb-1">superadmin</p>
                            <p class="name font-weight-bold mb-0"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="24534d48485d424146564d454a0a4c45504b564d1c1c644349454d480a474b49">[email&#160;protected]</a></p>
                            <p class="email text-muted mb-3"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="fe8997929287989b9c8c979f90d0969f8a918c97c6c6be99939f9792d09d9193">[email&#160;protected]</a></p>
                        </div>
                    </div>
                    <div class="dropdown-body">
                        <ul class="profile-nav p-0 pt-3">
                            <li class="nav-item">
                                <a href="javascript:void(0)" onclick="return changePassword()" class="nav-link">
                                    <i data-feather="unlock"></i>
                                    <span>Change Password</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="javascript:void(0)" onclick="return confirmLogout()" class="nav-link">
                                    <i data-feather="log-out"></i>
                                    <span>Log Out</span>
                                </a>
                            </li>

                            <form id="logout-form" action="/logout" method="POST" style="display: none;">
                                <input type="hidden" name="_token" value="Y16mNDkUQCQXCzAoH1X6ClaN4IVV07drbubabc9D" autocomplete="off">                            </form>


                        </ul>
                    </div>
                </div>
            </li>
        </ul>
    </div>
</nav>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
    function confirmLogout() {
        // Menampilkan konfirmasi SweetAlert
        Swal.fire({
            title: 'Apakah Anda yakin?',
            text: "Anda akan keluar dari akun ini.",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonText: 'Yes, Log Out',
            cancelButtonText: 'Cancel',
            reverseButtons: true
        }).then((result) => {
            if (result.isConfirmed) {
                // Jika user klik "Yes", submit form logout
                document.getElementById('logout-form').submit();
            } else {
                // Jika user klik "Cancel", tidak melakukan apa-apa
                Swal.fire(
                    'Dibatalkan',
                    'Anda tetap berada di halaman.',
                    'info'
                );
            }
        });

        return false; // Menghentikan aksi default (link) dan menghindari reload
    }
</script>
      <div class="page-content">
        <div class="row flex-grow" bis_skin_checked="1">
        <div class="col-md-4 grid-margin stretch-card" bis_skin_checked="1">
            <div class="card" bis_skin_checked="1">
                <div class="card-body" bis_skin_checked="1">
                    <div class="d-flex justify-content-between align-items-baseline" bis_skin_checked="1">
                        <h6 class="card-title mb-0">Simcard Available</h6>
                    </div>
                    <div class="d-flex justify-content-between align-items-baseline" bis_skin_checked="1">
                        <h1 class="" id="total_simcards"></h1>
                        <div class="mdi mdi-format-list-bulleted h2 text-muted"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4 grid-margin stretch-card" bis_skin_checked="1">
            <div class="card" bis_skin_checked="1">
                <div class="card-body" bis_skin_checked="1">
                    <div class="d-flex justify-content-between align-items-baseline" bis_skin_checked="1">
                        <h6 class="card-title mb-0">Simcard Almost Expiry</h6>
                    </div>
                    <div class="d-flex justify-content-between align-items-baseline" bis_skin_checked="1">
                        <h1 class="" id="almost_expiry"></h1>
                        <div class="mdi mdi-clock-alert h2 text-warning"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4 grid-margin stretch-card" bis_skin_checked="1">
            <div class="card" bis_skin_checked="1">
                <div class="card-body" bis_skin_checked="1">
                    <div class="d-flex justify-content-between align-items-baseline" bis_skin_checked="1">
                        <h6 class="card-title mb-0">Simcard Expired</h6>
                    </div>
                    <div class="d-flex justify-content-between align-items-baseline" bis_skin_checked="1">
                        <h1 class="" id="expired"></h1>
                        <div class="mdi mdi-calendar-clock h2 text-danger"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Kolom pertama -->
        <div class="col-md-12 grid-margin stretch-card">
            <div class="card">
                <div class="card-body">
                    <h6 class="card-title mb-3">Simcard Aktif / Almost Expired</h6>
                    <div class="table-responsive" style="max-height: 700px; overflow-y: auto;">
                        <table id="dataAlmostExpiry" class="table" style="width: 100%">
                            <thead>
                                <tr>
                                    <th>Phone Number</th>
                                    <th>Provider</th>
                                    <th>Expiration Date</th>
                                    <th>Days</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
      </div>
      <footer class="footer d-flex flex-column flex-md-row align-items-center justify-content-between">
  <p class="text-muted text-center text-md-left">Copyright &copy; 2025 <a href="https://smbgroup.io" target="_blank">SMB Group</a>. All rights reserved</p>
  <p class="text-muted text-center text-md-left mb-0 d-none d-md-block">Horas<i class="mb-1 text-primary ml-1 icon-small" data-feather="heart"></i></p>
</footer>    </div>
  </div>
  <script src="https://simcard-ina.smbgroup.io/assets/vendors/bootstrap-datepicker/bootstrap-datepicker.min.js"></script>
  <script src="https://simcard-ina.smbgroup.io/assets/vendors/feather-icons/feather.min.js"></script>
  <script src="https://simcard-ina.smbgroup.io/assets/vendors/jquery-tags-input/jquery.tagsinput.min.js"></script>
  <script src="https://simcard-ina.smbgroup.io/assets/js/template.js"></script>
  <script src="https://simcard-ina.smbgroup.io/assets/vendors/toastr/toastr.min.js"></script>
              <script>
                const dataAlmostExpiry = $('#dataAlmostExpiry');
                const dataExpiry = $('#dataExpiry');
                const total_simcards = $('#total_simcards');
                const almost_expiry = $('#almost_expiry');
                const expired = $('#expired');

                $(document).ready(function(){
                    $.getJSON(`/dashboard/summary`, function(data){
                        total_simcards.text(data.total_simcards.toLocaleString() || 0);
                        almost_expiry.text(data.almost_expiry.toLocaleString() || 0);
                        expired.text(data.expired.toLocaleString() || 0);
                    });
                });

                $(document).ready(function() {
                    $.ajaxSetup({
                        headers: {
                            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
                        }
                    });


                    table = dataAlmostExpiry.DataTable({
                        responsive: true,
                        processing: true,
                        serverSide: true,
                        ajax: {
                            url: '/dashboard/data',
                            method: 'POST',
                            data: function(d) {
                                d.search_value = d.search.value;  // Menyertakan nilai pencarian dari DataTables
                            }
                        },
                        columns: [{
                                data: 'phone_number',
                                orderable:false
                            },
                            {
                                data: 'provider_name',
                                render:renderProviderBadge,
                                orderable:false,
                            },
                            {
                                data: 'expiration_date',
                                searchable: false,
                                orderable:false,
                            },
                            {
                                data: 'days_until_expiration',
                                render: renderExpirationBadge,
                                searchable: false,
                                orderable:false
                            }
                        ]
                    });
                });
            </script>
          <script>
    toastr.options = {
        "positionClass": "toast-top-right", // sudut kanan atas
        "closeButton": true,
        "progressBar": true,
        "timeOut": "5000",
        "extendedTimeOut": "1000",
    };

    
    
    
    </script>
</body>

</html>
